<!DOCTYPE html>
<html>
<head>
    <title>Export to Excel via XLSX.js</title>
    <link href="http://cdn.kendostatic.com/2014.1.416/styles/kendo.common.min.css" rel="stylesheet" />
    <link href="http://cdn.kendostatic.com/2014.1.416/styles/kendo.default.min.css" rel="stylesheet" />
    <script src="loader.js"></script>
    <script src="../src/jszip.min.js"></script>
    <script>
        requireSync([
            "../src/jquery",
            "../src/kendo.ooxml",
            "../src/kendo.excel",
            "../src/kendo.grid"
        ]);
    </script>
</head>
<body>
    <h1>JavaScript-only export to Excel</h1>
    <h2>Supported browsers</h2>
    <ul>
      <li>Google Chrome</li>
      <li>Firefox</li>
      <li>IE10+</li>
    </ul>
    <div id="grid" style="height: 500px;width: 900px"></div>
    <script>
        $("#grid").kendoGrid({
          toolbar: ["excel"],
          dataSource: {
              transport: {
                  read: function(options) {
                    var data = [];
                    for (var i = 0; i < 150 * 1000; i++) {
                        data.push( {
                            ContactName: "Contact " + i,
                            ContactTitle: "Contact Title " + i,
                            CompanyName: "Company Name " + i
                        } );
                    }

                    options.success(data);
                  }
              },
              pageSize: 10
          },
          excel: {
              allPages: true
          },
          sortable: true,
          pageable: {
              refresh: true,
              pageSizes: true,
              buttonCount: 5
          },
          excelExport: function(e) {
//              e.preventDefault();
            console.log("generation done");
          },
          columns: [{
              field: "ContactName",
              title: "Contact Name",
              width: 300
          }, {
              field: "ContactTitle",
              title: "Contact Title",
              width: 250
          }, {
              field: "CompanyName",
              title: "Company Name"
          }
          ],
          columnMenu: false,
          groupable: true,
          resizable: true,
          reorderable: true
      });

      var start;
      $(".k-grid-excel").click(function() {
          start = new Date();
      });
  </script>
</body>
</html>
