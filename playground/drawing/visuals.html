<!DOCTYPE html>
<html>
  <head>
    <link type="text/css" href="../../styles/web/kendo.common.css" rel="stylesheet/less"/>
    <link type="text/css" href="../../styles/web/kendo.silver.css" rel="stylesheet/less"/>
    <link type="text/css" href="../../styles/dataviz/kendo.dataviz.css" rel="stylesheet/less"/>
    <link type="text/css" href="../../styles/dataviz/kendo.dataviz.silver.css" rel="stylesheet"/>
    
    <script src="../../src/jquery.js"></script>
    <script src="../../src/kendo.core.js"></script>
    <script src="../../src/kendo.color.js"></script>
                
    <script src="../../src/kendo.data.js"></script>
    <script src="../../src/kendo.binder.js"></script>
               
    <script src="../../src/kendo.popup.js"></script>
    <script src="../../src/kendo.userevents.js"></script>
    <script src="../../src/kendo.draganddrop.js"></script>
    <script src="../../src/kendo.slider.js"></script>
    <script src="../../src/kendo.colorpicker.js"></script>
    <script src="../../src/kendo.button.js"></script>
    <script src="../../src/kendo.numerictextbox.js"></script>
    <script src="../../src/kendo.list.js"></script>
    <script src="../../src/kendo.dropdownlist.js"></script>
                
    <script src="../../src/util/main.js"></script>
    <script src="../../src/mixins/observers.js"></script>
    <script src="../../src/geometry/main.js"></script>
    <script src="../../src/drawing/core.js"></script>         
    <script src="../../src/drawing/mixins.js"></script>
    <script src="../../src/drawing/text-metrics.js"></script>
    <script src="../../src/drawing/shapes.js"></script>
    <script src="../../src/drawing/animation.js"></script>
    <script src="../../src/drawing/parser.js"></script>
    <script src="../../src/drawing/svg.js"></script>
    <script src="../../src/drawing/canvas.js"></script>
    <script src="../../src/drawing/vml.js"></script>
                
    <script src="../../src/kendo.dataviz.core.js"></script>
    <script src="../../src/kendo.dataviz.chart.js"></script>
    <script src="../../src/kendo.dataviz.sparkline.js"></script>
    <script src="../../src/kendo.dataviz.stock.js"></script>
    <script src="../../src/kendo.dataviz.themes.js"></script>
    <script>
    $(function() {
        initLineChart();
        initBarChart();
    });

    
    function initLineChart() {

        $("#line").kendoChart({
            dataSource: {
                data: grandSlam
            },
            title: {
                text: "Roger Federer Grand Slam tournament performance"
            },
            legend: {
                position: "bottom"
            },
            seriesDefaults: {
                type: "line",
                markers: {
                    visual: customVisual
                }
            },
            series: [{
                field: "win",
                name: "Wins",
                noteTextField: "extremum",
                notes: {
                    visual: customVisual,
                    position: "bottom"
                }
            },{
                field: "loss",
                name: "Losses",
                errorBars: {
                    visual: customVisual,
                    value: "stddev"
                }
            }],
            valueAxis: {
                line: {
                    visible: false
                }
            },
            categoryAxis: {
                field: "year",
                majorGridLines: {
                    visible: false
                }
            },
            tooltip: {
                visible: true,
                template: "#= series.name #: #= value #"
            }
        });      
    }

    function initBarChart() {
        $("#bar").kendoChart({
            title: {
                text: "Site Visitors Stats \n /thousands/",
                visual: labelsVisual
            },
            legend: {
                visible: false
            },
            seriesDefaults: {
                type: "bar",
                labels: {
                    visible: true,
                    visual: labelsVisual
                },
                stack: true,                   
                visual: customVisual
            },
            panes: [{clip: false}],
            series: [{
                name: "Total Visits",
                data: [10000, 56000]                    
            }, {
                name: "Unique visitors",
                data: [52000, 20000]
            }],
            valueAxis: {
                line: {
                    visible: false
                },
                labels: {
                    visual: labelsVisual
                },
                minorGridLines: {
                    visible: true
                }
            },
            categoryAxis: {
                categories: ["Jan"],
                majorGridLines: {
                    visible: false
                },
                labels: {
                    visual: labelsVisual
                }
            },
            tooltip: {
                visible: true,
                template: "#= series.name #: #= value #"
            }
        });
        
    }

    function labelsVisual(args) {
        var visual = args.createVisual();
        createArcs(args.box, visual);
        return visual;
    }
    
    function customVisual(args) {
        var drawing = kendo.drawing;
        var geometry = kendo.geometry;

        var group = new drawing.Group();
        createArcs(args.box, group, args.options.background);
      
        return group;
    }
    
    function createArcs(box, visual, color) {

        var width = box.width();            
        var height = box.height();
        var thirdWidth = width / 3;
        var thirdHeight = height / 3;
        var center = box.center();
        var ballsRadius; 
        var ball1Center;
        var ball2Center;
        var korCenter = center;
        var korRadiusX;
        var korRadiusY;

        if (width <= height) {
            korRadiusX = thirdWidth / 2;
            korRadiusY = height / 2;
            ballsRadius = thirdWidth / 2;
            ball1Center = {
                x: box.x1 + korRadiusX,
                y: box.y2 - thirdHeight / 2
            };
            ball2Center = {
                x: box.x2 - korRadiusX,
                y: box.y2 - thirdHeight / 2
            };
        } else {
            korRadiusX = width / 2;
            korRadiusY = thirdHeight / 2;
            ballsRadius = thirdHeight / 2;
            ball1Center = {
                x: box.x1 + korRadiusY,
                y: box.y1 + thirdHeight / 2
            };
            ball2Center = {
                x: box.x1 + korRadiusY,
                y: box.y2 - thirdHeight / 2
            };
        }

        visual.insertAt(createArc(color, ball1Center, ballsRadius), 0);
        visual.insertAt(createArc(color, korCenter, korRadiusX, korRadiusY), 1);
        visual.insertAt(createArc(color, ball2Center, ballsRadius), 2);
    }
    
    function createArc(color, center, radiusX, radiusY) {
        var drawing = kendo.drawing;
        var geometry = kendo.geometry;
        var arcGeometry = new geometry.Arc([center.x, center.y], {
            radiusX: radiusX,
            radiusY: radiusY,
            startAngle: 0,
            endAngle: 360
        });
        var arc = new drawing.Arc(arcGeometry, {
            fill: {
                color: color || "limegreen"
            }
        });
        return arc;
    }
    
    </script>
    <style>
        .k-chart {
            width: 800px;
            height: 500px;
            float: left;
        }
        #surface {
            width: 400px;
            height: 500px;
            float: left;
        }
    </style>
  </head>
  <body>
        <div id="area"></div>
      <div id="donut"></div>
      <div id="pie"></div>
      <div id="bar"></div>
      <div id="column"></div>
      <div id="boxplot"></div>
      <div id="stock-chart"></div>
      <div id="water"></div>
      <div id="range"></div>
      <div id="bullet"></div>
      <div id="bubble"></div>
      <button>redraw</button><br />
      PDF:
      <button onclick="pdf('#donut')"       >donut</button>
      <button onclick="pdf('#pie')"         >pie</button>
      <button onclick="pdf('#column')"      >column</button>
      <button onclick="pdf('#boxplot')"     >boxplot</button>
      <button onclick="pdf('#stock-chart')" >stock-chart</button>
      <button onclick="pdf('#water')"       >water</button>
      <button onclick="pdf('#range')"       >range</button>
      <button onclick="pdf('body')">page</button>
      <script>
        function pdf(sel) {
            kendo.drawing.drawDOM($(sel))
            .then(function(group) {
                return kendo.drawing.exportPDF(group);
            })
            .done(function(data){
                kendo.saveAs({ dataURI: data, fileName: "kendo.pdf" });
            });
        }
      </script>
  </body>
</html>
