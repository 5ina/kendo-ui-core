<%
def encode(value)
    value.to_s.gsub("&", "&amp;").gsub("<", "&lt;").gsub(">", "&gt;")
end

def output(title, issues)
    return if issues.length == 0

    out = "<p><strong>#{encode(title)}</strong></p><ul>"

    issues.each do |issue|
        out += "<li>#{encode(issue.title)}</li>"
    end

    out += "</ul>"

    out
end

def component_icon(component)
    map = {
        'DropDownList' => 'DropDown',
        'DateTimePicker' => 'DatePicker',
        'Linear Gauge' => 'Gauge',
        'Radial Gauge' => 'Gauge',
        'Sparkline' => 'Sparklines',
        'StockChart' => 'ChartStock'
    }

    encode(map[component] || component)
end

def icon_for(component)
    "<img src='/libraries/Kendo_UI_Icons_32x32/#{component_icon(component)}_kendoui.sflb' class='poBoxIcon' width='32' height='32' alt='Kendo UI #{component} Icon'>"
end

def date
    Time.now.strftime("%B %d, %Y")
end
%>

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Changelog for Kendo UI v<%= VERSION %> (<%= date %>)</title>
    <style>
        html, body {
            margin: 0;
            padding: 0;
        }

        body {
            font: .75em/1.5 Tahoma, sans-serif;
        }

        h1 {
            font-size: 2.2em;
            font-size: normal;
        }

        h2 {
            font-size: 2em;
            font-weight: normal;

            margin: 1.2em 0 .3em;
            padding-bottom: .2em;
        }

        #page {
            width: 50em;
            margin: 0 auto 2em;
            border-radius: 0 0 1em 1em;
            box-shadow: 0 0 10px #ccc;
            padding: 1em 2em 2em;
        }

        .poBoxIcon {
            float: left;
            font-size: 2em;
            margin: 1.2em .5em 0 0;
        }

        .poTopLine {
            border-top: 2px solid #e1e1e1;
            margin: 17px 0 40px 0;
        }
    </style>

    <base href="http://www.telerik.com/support/whats-new/kendo-ui-web/release-history">
</head>
<body>
    <div id="page">
        <h1 class="title">Release notes for Kendo UI v<%= VERSION %></h1>

% suites.each do |suite|
        <h1><%= encode(suite.title) %></h1>
        <div class="tClear poTopLine">
            <div class="poBoxIconText">
                <%= output("What's new", suite.features) %>
                <%= output("What's fixed", suite.bugs) %>
            </div>
        </div>

% if suite.new_components.any? then
        <h1>New UI Widgets</h1>
% suite.new_components.each do |issue|
% next if exclude.include? issue.title.downcase
        <div class="tClear poTopLine">
            <div class="poBoxIconText">
                <h2><%= encode(issue.title) %></h2>
            </div>
        </div>
% end

        <h1>UI Widgets Features and Updates</h1>
% end

% suite.components.each do |component_title, component|
% next if exclude.include? component_title.downcase
        <div class="tClear poTopLine">
            <h2><%= encode(component_title) %></h2>
            <%= output("What's new", component.features) %>
            <%= output("What's fixed", component.bugs) %>
        </div>
% end
% end
    </div>
</body>
</html>
