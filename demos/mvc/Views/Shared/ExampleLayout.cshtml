@{
    Layout = "~/Views/Shared/_Layout.cshtml";

    ViewBag.SuppressFooter = true;

    string navProduct = ViewBag.NavProduct;
}
<script>
    window.kendoTheme = "@ViewBag.Theme";
    window.kendoCommonFile = "@ViewBag.CommonFile";
</script>

<script src="@Url.Content("~/content/shared/js/theme-chooser.js")"></script>

<script>
    var path = "../";
</script>

@Html.Partial("WebSearchScript")
<div id="example-sidebar">
    <div id="example-search-wrapper" class="search-wrapper">
        <div class="search">
            <input id="example-search" placeholder="Search demos"/>
        </div>
    </div>
    <div id="example-nav-bar">
        <a href="#" title="See all components" id="back-forward" class="back-nav">All Components</a>
    </div>
    <div id="nav-wrapper">
        <div id="nav">
            <div id="root-nav">
            @foreach (IGrouping<string, NavigationWidget> category in ViewBag.Categories)
            {
                <ul class="root-nav-categories">
                    @if (category.Any(c => c.ShouldInclude((string)ViewBag.NavProduct)))
                    {
                    <li>
                        <h3>@category.Key</h3>
                        <ul class="root-nav-widgets">
                        @foreach (var widget in category)
                        {
                            if (widget.ShouldInclude((string)ViewBag.NavProduct))
                            {
                            <li>@Html.WidgetLink(widget, (string)ViewBag.NavProduct)</li>
                            }
                        }
                        </ul>
                    </li>
                    }
                </ul>
            }
            </div>
            <div id="example-nav">
                <h3>@ViewBag.CurrentWidget.Text</h3>
                <ul>
                @foreach (NavigationExample example in ViewBag.CurrentWidget.Items)
                {
                    if (example.ShouldInclude(navProduct))
                    {
                        <li>@Html.ExampleLink(example)</li>
                    }
                }
                </ul>
            </div>
        </div>
        <script>
            $("#back-forward").on("click", function (e) {
                if ($(this).hasClass("back-nav")) {
                    $(this).removeClass("back-nav").addClass("forward-nav").text("@ViewBag.CurrentWidget.Text").attr("title", "See @ViewBag.CurrentWidget.Text demos");
                    $("#nav").addClass("root");

                }
                else {
                    $(this).removeClass("forward-nav").addClass("back-nav").text("All Components").attr("title", "See all components");
                    $("#nav").removeClass("root");
                }

                e.preventDefault();
            });

            function setSearchListWidth() {
                $("#example-search").data("kendoExampleSearch");
            }

            $(document).ready(function () {
                resizeContainers();
                setSearchListWidth();
            });
        </script>
    </div>
</div>
<div id="main">
    <a href="#" id="sidebar-toggle"><span></span></a>

    @Html.Partial("ThemeChooser")

    <h1 id="exampleTitle">
        @if (ViewBag.CurrentExample != null) {
            <span class="exampleIcon @ViewBag.CurrentWidget.SpriteCssClass"></span>
            <strong>@ViewBag.CurrentWidget.Text @(ViewBag.CurrentExample.Url.Contains("dashboard") ? "" : "/")</strong> @ViewBag.CurrentExample.Text
        }
    </h1>

    <div id="exampleWrap">
        <script>$("#exampleWrap").css("visibility", "hidden");</script>

        @if (ViewBag.Mobile) {
        <div id="example" class="k-content mobileExample @(ViewBag.CurrentWidget.Tablet ? "tablet km-tablet" : "")">

            <div id="device-wrapper">
                <div id="mobile-application-container">
                    @RenderBody()
                    @if (!ViewBag.MobileAngular) {
                    <div data-role="layout" data-id="examples">
                        <header data-role="header">
                            <div data-role="navbar">
                                <!--a class="nav-button" data-align="left" data-role="backbutton">Back</a-->
                                <span data-role="view-title"></span>
                                <a data-align="right" data-role="button" class="nav-button" href="#/">Index</a>
                            </div>
                        </header>
                    </div>
                    }
                </div>
            </div>

            @RenderSection("ExampleFooter", false)
        </div>
        <script>
            if ((kendo.support.browser.msie && kendo.support.browser.version < 10) || kendo.support.browser.opera) {
                $("#mobile-application-container")
                        .addClass("old-browser")
                        .empty()
                        .html("<div class='content'><span class='centered'><strong>Kendo UI Mobile</strong><span>is fully supported only in WebKit based browsers and IE10.</span><br><br>Please use a compatible desktop browser or open the examples in a mobile WebKit based browser or Windows Phone.</span></div>");
            }
        </script>
        } else {
            @RenderBody()

            if (ViewBag.Description != null) {
                <div class="box demo-description wide">
                    <h4>Description</h4>
                    @Html.Raw(ViewBag.Description)
                </div>
            }
        }
        <script>
            $(function(){ $("#exampleWrap").css("visibility", ""); });
        </script>
    </div>

<!--widget inspector-->
    <script>$(document).ready(function(){

        function kendoWidgetInstance(el) {
            el = $(el);
            return kendo.widgetInstance(el, kendo.ui) ||
                kendo.widgetInstance(el, kendo.mobile.ui) ||
                kendo.widgetInstance(el, kendo.dataviz.ui);
        }

        var widgets = [];
        var datasource = [];

        function haveWidget(w) {
            for (var i = widgets.length; --i >= 0;)
                if (widgets[i] === w) return true;
            return false;
        }

        $("#exampleWrap *").each(function(){
            var w = kendoWidgetInstance(this);
            if (w && !haveWidget(w)) {
                datasource.push({
                    name   : w.options.name,
                    index  : widgets.length
                });
                widgets.push(w);
            }
        });

        if (widgets.length == 0) {
            $("#inspector-container, .inspector-tab").hide();
        } else if (kendo.ui.Inspector) {
            $("#inspector-widgets").kendoDropDownList({
                dataSource     : datasource,
                dataTextField  : "name",
                dataValueField : "index",
                value          : 0,
                change         : function() {
                    inspector.reset(widgets[this.value()]);
                }
            });
            var inspector = $("#inspector").kendoInspector({
                showPicker : false,
                showEvents : false,
                docBaseUrl : "@ViewBag.Api",
                widget     : widgets[0]
            }).data("kendoInspector");
        }

    })</script>
<!--/widget inspector-->


        @{
        NavigationExample currentExample = ViewBag.CurrentExample;
        NavigationWidget currentWidget = ViewBag.CurrentWidget;
        var html = currentWidget.ShouldInclude("online") && currentExample.ShouldInclude("online") && navProduct != "online";
        var php = currentWidget.ShouldInclude("php") && currentExample.ShouldInclude("php") && navProduct != "php";
        var mvc = currentWidget.ShouldInclude("mvc") && currentExample.ShouldInclude("mvc") && navProduct != "mvc";
        var jsp = currentWidget.ShouldInclude("jsp") && currentExample.ShouldInclude("jsp") && navProduct != "jsp";
    }

    @if (ViewBag.ShowCodeStrip == true)
    {

        <div id="wrappers-source-code">
        @switch ((string)ViewBag.Product)
        {
            case "kendo-ui":
        <h2>HTML5/JavaScript source</h2>
                break;
            case "aspnet-mvc":
        <h2>ASP.NET MVC source</h2>
                break;
            case "php-ui":
        <h2>PHP source</h2>
                break;
            case "jsp-ui":
        <h2>JSP source</h2>
                break;
        }

        @if (html || php || jsp || mvc)
        {
            <div class="other-source">
                <h4>Also available for:</h4>
                <ul>
                    @if (html)
                    {
                    <li><a href="@Html.ProductExampleUrl(currentExample, "kendo-ui")">HTML5 / JavaScript</a></li>
                    }
                    @if (mvc)
                    {
                    <li><a href="@Html.ProductExampleUrl(currentExample, "aspnet-mvc")">ASP.NET MVC</a></li>
                    }
                    @if (jsp)
                    {
                    <li><a href="@Html.ProductExampleUrl(currentExample, "jsp-ui")">JSP</a></li>
                    }
                    @if (php)
                    {
                    <li><a href="@Html.ProductExampleUrl(currentExample, "php-ui")">PHP</a></li>
                    }
                </ul>
            </div>
        }

        </div>

        <div id="codeStrip">
            <div class="buttons-wrap">
            @if (ViewBag.Product == "kendo-ui")
            {
                <button type="button" class="try-kendo"><span class="k-icon"></span>Edit this example</button>
            }

            @if (!string.IsNullOrEmpty(ViewBag.Api))
            {
                <a class="documentation-link k-link" href="@ViewBag.Api">API Reference</a>
            }

            @{
                IEnumerable<ExampleFile> examples = ViewBag.ExampleFiles;
            }
            </div>

            @if (examples.Any())
            {
                <div id="source-code">
                    <ul>
                        @foreach (ExampleFile file in examples)
                        {
                            <li>@file.Name</li>
                        }
                        <!--[if gte IE 8]>-->
                        <li class="inspector-tab">Widget configuration</li>
                        <!--<![endif]-->
                    </ul>
                    @foreach (ExampleFile file in examples)
                    {
                        <div></div>
                    }
                    <!--[if gte IE 8]>-->
                    <div>
                        <div id="inspector-container">
                            <div id="inspector-header">
                              <label for="inspector-widgets">Select widget to inspect</label>
                              <select id="inspector-widgets"></select>
                            </div>
                            <div id="inspector"></div>
                        </div>
                    </div>
                    <!--<![endif]-->
                </div>
               <script>
                   (function () {
                       var ts = $("#source-code").kendoTabStrip({
                           animation: {
                               open: {
                                   effects: "fadeIn"
                               }
                           },
                           contentUrls: [
                                @Html.Raw(String.Join(",", examples.Select(file => "\"" + Url.Action("Index", "Source", new { path = file.Url } ) + "\"").ToArray()))
                           ],
                           contentLoad: function (e) {
                               var content = $(e.contentElement);
                               if (content.is("#source-code-1")) {
                                   var html = content.find('.prettyprint').text();
                                   content.data("html", content.find('.prettyprint').text());
                               }

                               prettyPrint();
                           }
                       }).data("kendoTabStrip");

                       ts.select(0);
                       $(window).resize(function () {
                           ts.resize();
                       });
                   })();

               dojo.configuration = {
                   url: "@Html.DojoRoot()",
                   cdnRoot: '@Html.CdnRoot()'
               };
               </script>
            }
        </div>
    }
    <div id="resources-technologies" class="box">
        @if (ViewBag.Forum != null || ViewBag.Documentation != null || ViewBag.CodeLibrary != null)
        {
        <div id="learning-resources" class="box-col">
            <h4>Support & learning resources</h4>
            <ul>
                @if (ViewBag.Forum != null)
                {
                <li><a href="@ViewBag.Forum">Forums</a></li>
                }
                @if (ViewBag.CodeLibrary != null)
                {
                <li><a href="@ViewBag.CodeLibrary">Code Libraries</a></li>
                }
                @if (ViewBag.Documentation != null)
                {
                <li><a href="@ViewBag.Documentation">Documentation</a></li>
                }
            </ul>
        </div>
        }
        <div id="technologies" class="box-col">


            @if (html || php || jsp || mvc)
            {
                <h4>@ViewBag.CurrentWidget.Text for other technologies</h4>
                <ul>
                    @if (html)
                    {
                    <li><a href="@Html.ProductExampleUrl(currentExample, "kendo-ui")">HTML5 / JavaScript</a></li>
                    }
                    @if (mvc)
                    {
                    <li><a href="@Html.ProductExampleUrl(currentExample, "aspnet-mvc")">ASP.NET MVC</a></li>
                    }
                    @if (jsp)
                    {
                    <li><a href="@Html.ProductExampleUrl(currentExample, "jsp-ui")">JSP</a></li>
                    }
                    @if (php)
                    {
                    <li><a href="@Html.ProductExampleUrl(currentExample, "php-ui")">PHP</a></li>
                    }
                </ul>
            }
        </div>
    </div>
    @Html.Partial("Footer")
</div>

<script>
    $(window).on("resize", function() {
      kendo.resize($(".k-chart"));
    });
    
    $(".try-kendo").click(function(e) {
        window.dojo.postSnippet($('#source-code-1').data('html'), window.location.href);
    });

    setTimeout(function(){ prettyPrint(); }, 100);
</script>
